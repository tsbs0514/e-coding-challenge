# 電気料金シミュレーション

ENECHANGE フロントエンドエンジニア課題として開発した電気料金シミュレーションアプリケーションです。

## 🚀 デモ

[GitHub Pages でデモを見る](https://tsbs0514.github.io/e-coding-challenge/)

## 📋 機能

- 郵便番号による電力エリア判定（東京電力・関西電力エリア）
- エリアに応じた電力会社・プランの動的選択
- リアルタイムバリデーション
- レスポンシブデザイン（スマートフォン対応）
- 電気料金のシミュレーション結果表示

## 🛠 技術スタック

- **Framework**: Next.js 15.4.5 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Form Management**: React Hook Form + Zod
- **Testing**: Jest + React Testing Library + Playwright
- **API Mocking**: MSW (Mock Service Worker)
- **Deployment**: GitHub Pages

## 📚 使用ライブラリと選定理由

### コアライブラリ

#### **Next.js 15.4.5**

- **選定理由**:
  - **このプロジェクトでの活用**: App Router による静的生成で高速な初期表示を実現。郵便番号入力フォームの即座な表示により、ユーザー体験を向上
  - **将来性**: 電力会社の追加や地域拡大時に、静的生成による SEO 最適化とパフォーマンスを維持
  - **開発効率**: Turbopack による高速な開発サーバーで、複雑なフォームロジックの開発を効率化

#### **React 19.1.0**

- **選定理由**:
  - **このプロジェクトでの活用**: Concurrent Features により、郵便番号入力時のリアルタイムエリアチェックを非ブロッキングで実行。コンポーネント指向により、複雑なUIを効率的に構築・管理
  - **将来性**: 電力料金計算の複雑化やリアルタイム更新機能追加時に、パフォーマンスを維持しつつ、UIの拡張性を確保
  - **開発効率**: 豊富なエコシステムと開発者コミュニティにより、問題解決や機能追加を迅速に実施

#### **TypeScript 5.x**

- **選定理由**:
  - **このプロジェクトでの活用**: 電力エリア判定ロジックの型安全性確保。`PowerArea`、`ContractCapacity` などの型定義でバグを防止
  - **将来性**: 新しい電力会社やプランの追加時に、型チェックによる安全性を確保
  - **開発効率**: 複雑なフォーム状態管理の型推論により、開発速度を向上

### フォーム管理

#### **React Hook Form 7.62.0**

- **選定理由**:
  - **このプロジェクトでの活用**: 郵便番号入力時のリアルタイムバリデーションと、電力会社選択による動的フィールド表示を高パフォーマンスで実現
  - **将来性**: 電力料金計算の複雑化や新しい入力項目追加時に、再レンダリングを最小化
  - **ユーザー体験**: フォーム送信時の即座なフィードバックと、エラー状態の適切な管理

#### **Zod 4.0.14**

- **選定理由**:
  - **このプロジェクトでの活用**: 郵便番号の正規表現チェック、電気代の最小値（1000 円）バリデーション、プラン別の契約容量必須チェックを型安全に実装
  - **将来性**: 新しい電力会社やプランの追加時に、スキーマ定義による一貫したバリデーション
  - **保守性**: 複雑な条件付きバリデーション（関西電力従量電灯 A は契約容量不要など）を明確に定義

#### **@hookform/resolvers 5.2.1**

- **選定理由**:
  - **このプロジェクトでの活用**: React Hook Form と Zod の統合により、型安全なフォームバリデーションを実現
  - **将来性**: 新しいバリデーションルール追加時の統合の簡素化
  - **開発効率**: 複雑な条件付きバリデーションの実装を効率化

### スタイリング

#### **Tailwind CSS 4.x**

- **選定理由**:
  - **このプロジェクトでの活用**: レスポンシブデザインでスマートフォン対応。郵便番号入力フィールドの適切なサイズ調整
  - **将来性**: 新しい UI コンポーネント追加時の一貫したデザインシステム
  - **開発効率**: 電力会社選択やプラン選択の UI を迅速に実装

#### **clsx 2.1.1**

- **選定理由**:
  - **このプロジェクトでの活用**: エラー状態に応じたフォームフィールドのスタイル変更を動的に管理
  - **将来性**: 複雑な条件付きスタイリングの管理を効率化
  - **保守性**: 電力会社選択による UI 状態変更の明確な管理

#### **tailwind-merge 3.3.1**

- **選定理由**:
  - **このプロジェクトでの活用**: Tailwind CSS のクラス名が重複した場合に、競合を解決し、意図したスタイルを適用。これにより、コンポーネントの再利用性を高めつつ、柔軟なスタイリングを実現
  - **将来性**: 新しい UI コンポーネントやデザイン変更時にも、スタイル競合を気にせず効率的に開発
  - **保守性**: クラス名の管理を簡素化し、予期せぬスタイル崩れを防止

### テスト

#### **Jest 30.0.5**

- **選定理由**:
  - **このプロジェクトでの活用**: 複雑なフォームロジック（エリア判定、電力会社選択、プラン選択）の単体テストを高速実行
  - **将来性**: 新しい電力会社やプランの追加時のテスト自動化
  - **品質保証**: 76 個のテストケースで主要ロジックの動作を保証

#### **React Testing Library 16.3.0**

- **選定理由**:
  - **このプロジェクトでの活用**: ユーザーの実際の操作（郵便番号入力 → 電力会社選択 → プラン選択）をテスト
  - **将来性**: 新しい UI 機能追加時のユーザー中心テスト
  - **品質保証**: アクセシビリティを考慮したテストで、幅広いユーザーに対応

#### **Playwright 1.54.2**

- **選定理由**:
  - **このプロジェクトでの活用**: 郵便番号入力からシミュレーション完了までの E2E フローを複数ブラウザでテスト
  - **将来性**: 新しい電力会社や地域追加時の E2E テスト自動化
  - **品質保証**: 実際のユーザー体験を保証

### API モック

#### **MSW 2.10.4**

- **選定理由**:
  - **このプロジェクトでの活用**: 郵便番号によるエリア判定 API をモックし、開発・テスト環境での一貫性を確保
  - **将来性**: 実際の API 実装時の段階的移行を可能
  - **開発効率**: バックエンド開発に依存しないフロントエンド開発を実現

### 開発ツール

#### **ESLint 9.x**

- **選定理由**:
  - **このプロジェクトでの活用**: 複雑なフォームロジックのコード品質を維持
  - **将来性**: チーム開発時の一貫したコーディングスタイル
  - **品質保証**: 早期のバグ発見とコードの可読性向上

#### **ts-node 10.9.2**

- **選定理由**:
  - **このプロジェクトでの活用**: Jest 設定での TypeScript 対応により、型安全なテスト環境を構築
  - **将来性**: 新しいテストケース追加時の TypeScript 活用
  - **開発効率**: テスト環境での型チェックによる開発速度向上

### その他

#### **react-icons 5.5.0**

- **選定理由**:
  - **このプロジェクトでの活用**: フォーム送信ボタンのアイコン表示で UX を向上
  - **将来性**: 新しい UI 要素追加時の豊富なアイコン選択肢
  - **一貫性**: 統一されたアイコンデザインシステム

## 📦 プロジェクト構造

```
src/
├── __tests__/           # テストファイル
│   ├── components/      # UIコンポーネントテスト
│   ├── schemas.test.ts  # スキーマテスト
│   └── useElectricForm.test.ts # カスタムフックテスト
├── components/          # UIコンポーネント
│   ├── ui/             # 基本UIコンポーネント
│   │   ├── Button.tsx
│   │   ├── FormField.tsx
│   │   ├── Input.tsx
│   │   └── Select.tsx
│   ├── layout/         # レイアウトコンポーネント
│   │   └── Section.tsx
│   └── ElectricSimulationForm.tsx
├── hooks/              # カスタムフック
│   └── useElectricForm.ts
├── lib/                # ユーティリティ・API
│   ├── api.ts
│   └── utils.ts
├── mocks/              # MSWハンドラー
│   ├── browser.ts
│   └── handlers.ts
├── schemas/            # Zodスキーマ
│   └── index.ts
├── types/              # TypeScript型定義
│   └── index.ts
└── app/                # Next.js App Router
    ├── globals.css
    ├── layout.tsx
    └── page.tsx
```

## 🏃‍♂️ セットアップ

### 前提条件

- Node.js 20.x 以上
- npm

### インストール

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run dev

# ブラウザで http://localhost:3000 を開く
```

### 利用可能なコマンド

```bash
# 開発サーバー起動
npm run dev

# 本番ビルド
npm run build

# 本番サーバー起動
npm start

# テスト実行
npm test

# テスト（watch モード）
npm run test:watch

# カバレッジ付きテスト
npm run test:coverage

# E2Eテスト実行
npm run test:e2e

# E2EテストUI
npm run test:e2e:ui

# Linting
npm run lint
```

## 🧪 テスト結果

### 単体テスト

- **テストスイート**: 6 個すべて通過 ✅
- **テストケース**: 76 個すべて通過 ✅
- **実行時間**: 約 3.2 秒

### カバレッジ

- **全体カバレッジ**: 54.67% (Statements)
- **UI コンポーネント**: 100% カバレッジ ✅
- **カスタムフック**: 95.94% カバレッジ ✅
- **ユーティリティ**: 100% カバレッジ ✅

### テスト対象

- ✅ フォームバリデーション（Zod スキーマ）
- ✅ UI コンポーネント（Button, Input, Select, FormField）
- ✅ カスタムフック（useElectricForm）
- ✅ エリア判定ロジック
- ✅ 電力会社・プラン選択ロジック

## 🎯 設計方針

### フォームバリデーション

- React Hook Form を使用した高パフォーマンスなフォーム管理
- Zod を使用した型安全なバリデーション
- リアルタイムバリデーション実装

### 状態管理

- カスタムフック (`useElectricForm`) で複雑なフォームロジックを分離
- 条件付きフィールド表示の実装
- エラー状態の適切な管理

### API 設計

- MSW を使用したモック API 実装
- 実際の API と同様のレスポンス構造
- エラーハンドリングの実装

### テスト戦略

- **単体テスト**: コンポーネント・関数レベル
- **E2E テスト**: ユーザーフロー全体

## 📱 対応ブラウザ

- Chrome (最新版)
- Firefox (最新版)
- Safari (最新版)
- Edge (最新版)

## 🎨 UI/UX

- モバイルファーストデザイン
- アクセシビリティ対応
- ローディング状態の表示
- エラーメッセージの適切な表示
- 直感的なフォーム操作

## 🚀 デプロイ

GitHub Actions を使用して GitHub Pages に自動デプロイされます。

1. `main` ブランチにプッシュ
2. 自動でビルド・テスト実行
3. GitHub Pages にデプロイ

## 🔧 開発環境

- **Node.js**: 20.x 以上
- **npm**: 最新版
- **TypeScript**: 5.x
- **ESLint**: 9.x
- **Jest**: 30.x
- **Playwright**: 1.54.x

---
